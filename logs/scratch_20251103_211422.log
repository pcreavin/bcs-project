============================================================
Training Configuration
============================================================
Config: configs/ablation_scratch.yaml
Device: mps | Batch size: 32 | Epochs: 20
Backbone: efficientnet_b0 | Finetune mode: scratch
Pretrained: False | Learning rate: 0.0003
Early stopping: True (patience=5, monitor=val_macro_f1)
Output directory: outputs/ablation_scratch
============================================================

Building datasets...
Train samples: 37496 | Val samples: 8035

Creating model...
Model created: 4,013,953/4,013,953 parameters trainable (100.0%)

Starting training...
------------------------------------------------------------
  Epoch 01 | Step   50 | Loss: 1.9883
  Epoch 01 | Step  100 | Loss: 1.5304
  Epoch 01 | Step  150 | Loss: 2.1451
  Epoch 01 | Step  200 | Loss: 1.8096
  Epoch 01 | Step  250 | Loss: 1.7305
  Epoch 01 | Step  300 | Loss: 1.9039
  Epoch 01 | Step  350 | Loss: 1.6274
  Epoch 01 | Step  400 | Loss: 2.1283
  Epoch 01 | Step  450 | Loss: 1.3604
  Epoch 01 | Step  500 | Loss: 1.7379
  Epoch 01 | Step  550 | Loss: 1.5514
  Epoch 01 | Step  600 | Loss: 1.5191
  Epoch 01 | Step  650 | Loss: 1.5411
  Epoch 01 | Step  700 | Loss: 1.5293
  Epoch 01 | Step  750 | Loss: 1.7467
  Epoch 01 | Step  800 | Loss: 1.6642
  Epoch 01 | Step  850 | Loss: 1.8341
  Epoch 01 | Step  900 | Loss: 1.5203
  Epoch 01 | Step  950 | Loss: 1.4194
  Epoch 01 | Step 1000 | Loss: 1.7292
  Epoch 01 | Step 1050 | Loss: 1.7030
  Epoch 01 | Step 1100 | Loss: 1.8436
  Epoch 01 | Step 1150 | Loss: 1.4046
Epoch 01 | Train Loss: 1.7354 | Val Acc: 0.3078 | Val Macro-F1: 0.2457 | Underweight Recall: 0.2018
  -> New best model saved (Macro-F1: 0.2457)
------------------------------------------------------------
  Epoch 02 | Step   50 | Loss: 1.7341
  Epoch 02 | Step  100 | Loss: 1.5578
  Epoch 02 | Step  150 | Loss: 1.6908
  Epoch 02 | Step  200 | Loss: 1.4834
  Epoch 02 | Step  250 | Loss: 1.7620
  Epoch 02 | Step  300 | Loss: 1.4967
  Epoch 02 | Step  350 | Loss: 1.3897
  Epoch 02 | Step  400 | Loss: 1.5213
  Epoch 02 | Step  450 | Loss: 1.5799
  Epoch 02 | Step  500 | Loss: 1.5636
  Epoch 02 | Step  550 | Loss: 1.3639
  Epoch 02 | Step  600 | Loss: 1.5826
  Epoch 02 | Step  650 | Loss: 1.4627
  Epoch 02 | Step  700 | Loss: 1.5433
  Epoch 02 | Step  750 | Loss: 1.4131
  Epoch 02 | Step  800 | Loss: 1.4890
  Epoch 02 | Step  850 | Loss: 1.3864
  Epoch 02 | Step  900 | Loss: 1.3484
  Epoch 02 | Step  950 | Loss: 1.3000
  Epoch 02 | Step 1000 | Loss: 1.6326
  Epoch 02 | Step 1050 | Loss: 1.6131
  Epoch 02 | Step 1100 | Loss: 1.3681
  Epoch 02 | Step 1150 | Loss: 1.5810
Epoch 02 | Train Loss: 1.5033 | Val Acc: 0.3599 | Val Macro-F1: 0.3255 | Underweight Recall: 0.1673
  -> New best model saved (Macro-F1: 0.3255)
------------------------------------------------------------
  Epoch 03 | Step   50 | Loss: 1.2674
  Epoch 03 | Step  100 | Loss: 1.3361
  Epoch 03 | Step  150 | Loss: 1.4813
  Epoch 03 | Step  200 | Loss: 1.6064
  Epoch 03 | Step  250 | Loss: 1.3971
  Epoch 03 | Step  300 | Loss: 1.2805
  Epoch 03 | Step  350 | Loss: 1.3731
  Epoch 03 | Step  400 | Loss: 1.2783
  Epoch 03 | Step  450 | Loss: 1.3437
  Epoch 03 | Step  500 | Loss: 1.4789
  Epoch 03 | Step  550 | Loss: 1.1667
  Epoch 03 | Step  600 | Loss: 1.6504
  Epoch 03 | Step  650 | Loss: 1.2184
  Epoch 03 | Step  700 | Loss: 1.4967
  Epoch 03 | Step  750 | Loss: 1.4727
  Epoch 03 | Step  800 | Loss: 1.4750
  Epoch 03 | Step  850 | Loss: 1.2840
  Epoch 03 | Step  900 | Loss: 1.3206
  Epoch 03 | Step  950 | Loss: 1.4989
  Epoch 03 | Step 1000 | Loss: 1.5445
  Epoch 03 | Step 1050 | Loss: 1.3213
  Epoch 03 | Step 1100 | Loss: 1.5586
  Epoch 03 | Step 1150 | Loss: 1.2175
Epoch 03 | Train Loss: 1.3611 | Val Acc: 0.4356 | Val Macro-F1: 0.4264 | Underweight Recall: 0.2230
  -> New best model saved (Macro-F1: 0.4264)
------------------------------------------------------------
  Epoch 04 | Step   50 | Loss: 1.1516
  Epoch 04 | Step  100 | Loss: 1.3217
  Epoch 04 | Step  150 | Loss: 1.3118
  Epoch 04 | Step  200 | Loss: 1.2280
  Epoch 04 | Step  250 | Loss: 1.3549
  Epoch 04 | Step  300 | Loss: 1.0740
  Epoch 04 | Step  350 | Loss: 1.1522
  Epoch 04 | Step  400 | Loss: 1.1977
  Epoch 04 | Step  450 | Loss: 1.1676
  Epoch 04 | Step  500 | Loss: 1.2098
  Epoch 04 | Step  550 | Loss: 1.4732
  Epoch 04 | Step  600 | Loss: 1.4058
  Epoch 04 | Step  650 | Loss: 1.1571
  Epoch 04 | Step  700 | Loss: 1.2341
  Epoch 04 | Step  750 | Loss: 1.1935
  Epoch 04 | Step  800 | Loss: 1.3199
  Epoch 04 | Step  850 | Loss: 1.2096
  Epoch 04 | Step  900 | Loss: 1.1709
  Epoch 04 | Step  950 | Loss: 1.2837
  Epoch 04 | Step 1000 | Loss: 1.2827
  Epoch 04 | Step 1050 | Loss: 1.1976
  Epoch 04 | Step 1100 | Loss: 1.5162
  Epoch 04 | Step 1150 | Loss: 1.0674
Epoch 04 | Train Loss: 1.2390 | Val Acc: 0.4641 | Val Macro-F1: 0.4630 | Underweight Recall: 0.5381
  -> New best model saved (Macro-F1: 0.4630)
------------------------------------------------------------
  Epoch 05 | Step   50 | Loss: 1.3001
  Epoch 05 | Step  100 | Loss: 0.8901
  Epoch 05 | Step  150 | Loss: 1.1633
  Epoch 05 | Step  200 | Loss: 1.0269
  Epoch 05 | Step  250 | Loss: 1.2574
  Epoch 05 | Step  300 | Loss: 1.0972
  Epoch 05 | Step  350 | Loss: 1.2769
  Epoch 05 | Step  400 | Loss: 1.0336
  Epoch 05 | Step  450 | Loss: 0.9378
  Epoch 05 | Step  500 | Loss: 1.0127
  Epoch 05 | Step  550 | Loss: 0.8785
  Epoch 05 | Step  600 | Loss: 1.0993
  Epoch 05 | Step  650 | Loss: 0.9331
  Epoch 05 | Step  700 | Loss: 1.3927
  Epoch 05 | Step  750 | Loss: 0.9704
  Epoch 05 | Step  800 | Loss: 1.5440
  Epoch 05 | Step  850 | Loss: 1.0509
  Epoch 05 | Step  900 | Loss: 1.0016
  Epoch 05 | Step  950 | Loss: 1.0771
  Epoch 05 | Step 1000 | Loss: 1.1270
  Epoch 05 | Step 1050 | Loss: 1.0421
  Epoch 05 | Step 1100 | Loss: 0.9938
  Epoch 05 | Step 1150 | Loss: 1.2399
Epoch 05 | Train Loss: 1.0810 | Val Acc: 0.5344 | Val Macro-F1: 0.5305 | Underweight Recall: 0.3345
  -> New best model saved (Macro-F1: 0.5305)
------------------------------------------------------------
  Epoch 06 | Step   50 | Loss: 0.7794
  Epoch 06 | Step  100 | Loss: 0.6025
  Epoch 06 | Step  150 | Loss: 0.7671
  Epoch 06 | Step  200 | Loss: 0.6286
  Epoch 06 | Step  250 | Loss: 1.0026
  Epoch 06 | Step  300 | Loss: 0.7683
  Epoch 06 | Step  350 | Loss: 0.8743
  Epoch 06 | Step  400 | Loss: 0.9250
  Epoch 06 | Step  450 | Loss: 0.8404
  Epoch 06 | Step  500 | Loss: 0.8970
  Epoch 06 | Step  550 | Loss: 0.6611
  Epoch 06 | Step  600 | Loss: 0.9722
  Epoch 06 | Step  650 | Loss: 0.8167
  Epoch 06 | Step  700 | Loss: 1.0348
  Epoch 06 | Step  750 | Loss: 0.8246
  Epoch 06 | Step  800 | Loss: 0.9014
  Epoch 06 | Step  850 | Loss: 0.9248
  Epoch 06 | Step  900 | Loss: 1.0639
  Epoch 06 | Step  950 | Loss: 0.8767
  Epoch 06 | Step 1000 | Loss: 0.6822
  Epoch 06 | Step 1050 | Loss: 0.8471
  Epoch 06 | Step 1100 | Loss: 0.7270
  Epoch 06 | Step 1150 | Loss: 0.9651
Epoch 06 | Train Loss: 0.8595 | Val Acc: 0.5867 | Val Macro-F1: 0.5905 | Underweight Recall: 0.5460
  -> New best model saved (Macro-F1: 0.5905)
------------------------------------------------------------
  Epoch 07 | Step   50 | Loss: 0.4515
  Epoch 07 | Step  100 | Loss: 0.4725
  Epoch 07 | Step  150 | Loss: 0.3720
  Epoch 07 | Step  200 | Loss: 0.7662
  Epoch 07 | Step  250 | Loss: 0.5054
  Epoch 07 | Step  300 | Loss: 0.8033
  Epoch 07 | Step  350 | Loss: 0.5151
  Epoch 07 | Step  400 | Loss: 0.8649
  Epoch 07 | Step  450 | Loss: 0.4207
  Epoch 07 | Step  500 | Loss: 0.6224
  Epoch 07 | Step  550 | Loss: 0.5594
  Epoch 07 | Step  600 | Loss: 0.6685
  Epoch 07 | Step  650 | Loss: 0.6064
  Epoch 07 | Step  700 | Loss: 0.5207
  Epoch 07 | Step  750 | Loss: 0.6648
  Epoch 07 | Step  800 | Loss: 0.6386
  Epoch 07 | Step  850 | Loss: 0.5623
  Epoch 07 | Step  900 | Loss: 0.4399
  Epoch 07 | Step  950 | Loss: 0.7288
  Epoch 07 | Step 1000 | Loss: 0.6197
  Epoch 07 | Step 1050 | Loss: 0.7812
  Epoch 07 | Step 1100 | Loss: 0.6349
  Epoch 07 | Step 1150 | Loss: 0.7241
Epoch 07 | Train Loss: 0.6251 | Val Acc: 0.5939 | Val Macro-F1: 0.5946 | Underweight Recall: 0.6655
  -> New best model saved (Macro-F1: 0.5946)
------------------------------------------------------------
  Epoch 08 | Step   50 | Loss: 0.4241
  Epoch 08 | Step  100 | Loss: 0.4068
  Epoch 08 | Step  150 | Loss: 0.3953
  Epoch 08 | Step  200 | Loss: 0.4366
  Epoch 08 | Step  250 | Loss: 0.4042
  Epoch 08 | Step  300 | Loss: 0.4227
  Epoch 08 | Step  350 | Loss: 0.6932
  Epoch 08 | Step  400 | Loss: 0.3553
  Epoch 08 | Step  450 | Loss: 0.3707
  Epoch 08 | Step  500 | Loss: 0.3916
  Epoch 08 | Step  550 | Loss: 0.3734
  Epoch 08 | Step  600 | Loss: 0.5682
  Epoch 08 | Step  650 | Loss: 0.5050
  Epoch 08 | Step  700 | Loss: 0.5193
  Epoch 08 | Step  750 | Loss: 0.5003
  Epoch 08 | Step  800 | Loss: 0.4445
  Epoch 08 | Step  850 | Loss: 0.4713
  Epoch 08 | Step  900 | Loss: 0.3807
  Epoch 08 | Step  950 | Loss: 0.5426
  Epoch 08 | Step 1000 | Loss: 0.3969
  Epoch 08 | Step 1050 | Loss: 0.5852
  Epoch 08 | Step 1100 | Loss: 0.5336
  Epoch 08 | Step 1150 | Loss: 0.5206
Epoch 08 | Train Loss: 0.4615 | Val Acc: 0.6246 | Val Macro-F1: 0.6308 | Underweight Recall: 0.6106
  -> New best model saved (Macro-F1: 0.6308)
------------------------------------------------------------
  Epoch 09 | Step   50 | Loss: 0.3324
  Epoch 09 | Step  100 | Loss: 0.4058
  Epoch 09 | Step  150 | Loss: 0.4067
  Epoch 09 | Step  200 | Loss: 0.4024
  Epoch 09 | Step  250 | Loss: 0.4686
  Epoch 09 | Step  300 | Loss: 0.3386
  Epoch 09 | Step  350 | Loss: 0.3713
  Epoch 09 | Step  400 | Loss: 0.3820
  Epoch 09 | Step  450 | Loss: 0.3302
  Epoch 09 | Step  500 | Loss: 0.4814
  Epoch 09 | Step  550 | Loss: 0.3519
  Epoch 09 | Step  600 | Loss: 0.3637
  Epoch 09 | Step  650 | Loss: 0.4154
  Epoch 09 | Step  700 | Loss: 0.3660
  Epoch 09 | Step  750 | Loss: 0.3756
  Epoch 09 | Step  800 | Loss: 0.4436
  Epoch 09 | Step  850 | Loss: 0.3972
  Epoch 09 | Step  900 | Loss: 0.4922
  Epoch 09 | Step  950 | Loss: 0.3789
  Epoch 09 | Step 1000 | Loss: 0.4105
  Epoch 09 | Step 1050 | Loss: 0.3564
  Epoch 09 | Step 1100 | Loss: 0.4387
  Epoch 09 | Step 1150 | Loss: 0.5055
Epoch 09 | Train Loss: 0.4044 | Val Acc: 0.6402 | Val Macro-F1: 0.6474 | Underweight Recall: 0.5903
  -> New best model saved (Macro-F1: 0.6474)
------------------------------------------------------------
  Epoch 10 | Step   50 | Loss: 0.3254
  Epoch 10 | Step  100 | Loss: 0.3258
  Epoch 10 | Step  150 | Loss: 0.3756
  Epoch 10 | Step  200 | Loss: 0.3066
  Epoch 10 | Step  250 | Loss: 0.4053
  Epoch 10 | Step  300 | Loss: 0.3472
  Epoch 10 | Step  350 | Loss: 0.3307
  Epoch 10 | Step  400 | Loss: 0.4263
  Epoch 10 | Step  450 | Loss: 0.4122
  Epoch 10 | Step  500 | Loss: 0.3443
  Epoch 10 | Step  550 | Loss: 0.3557
  Epoch 10 | Step  600 | Loss: 0.3043
  Epoch 10 | Step  650 | Loss: 0.4743
  Epoch 10 | Step  700 | Loss: 0.4045
  Epoch 10 | Step  750 | Loss: 0.5165
  Epoch 10 | Step  800 | Loss: 0.3082
  Epoch 10 | Step  850 | Loss: 0.3042
  Epoch 10 | Step  900 | Loss: 0.3958
  Epoch 10 | Step  950 | Loss: 0.3350
  Epoch 10 | Step 1000 | Loss: 0.3557
  Epoch 10 | Step 1050 | Loss: 0.3824
  Epoch 10 | Step 1100 | Loss: 0.3928
  Epoch 10 | Step 1150 | Loss: 0.7041
Epoch 10 | Train Loss: 0.3731 | Val Acc: 0.6528 | Val Macro-F1: 0.6562 | Underweight Recall: 0.6159
  -> New best model saved (Macro-F1: 0.6562)
------------------------------------------------------------
  Epoch 11 | Step   50 | Loss: 0.2958
  Epoch 11 | Step  100 | Loss: 0.3576
  Epoch 11 | Step  150 | Loss: 0.2973
  Epoch 11 | Step  200 | Loss: 0.3360
  Epoch 11 | Step  250 | Loss: 0.3083
  Epoch 11 | Step  300 | Loss: 0.2771
  Epoch 11 | Step  350 | Loss: 0.3622
  Epoch 11 | Step  400 | Loss: 0.3923
  Epoch 11 | Step  450 | Loss: 0.2895
  Epoch 11 | Step  500 | Loss: 0.4514
  Epoch 11 | Step  550 | Loss: 0.2844
  Epoch 11 | Step  600 | Loss: 0.3666
  Epoch 11 | Step  650 | Loss: 0.3337
  Epoch 11 | Step  700 | Loss: 0.3693
  Epoch 11 | Step  750 | Loss: 0.3746
  Epoch 11 | Step  800 | Loss: 0.3780
  Epoch 11 | Step  850 | Loss: 0.4304
  Epoch 11 | Step  900 | Loss: 0.3436
  Epoch 11 | Step  950 | Loss: 0.3301
  Epoch 11 | Step 1000 | Loss: 0.5350
  Epoch 11 | Step 1050 | Loss: 0.4431
  Epoch 11 | Step 1100 | Loss: 0.3265
  Epoch 11 | Step 1150 | Loss: 0.3772
Epoch 11 | Train Loss: 0.3685 | Val Acc: 0.6595 | Val Macro-F1: 0.6652 | Underweight Recall: 0.6336
  -> New best model saved (Macro-F1: 0.6652)
------------------------------------------------------------
  Epoch 12 | Step   50 | Loss: 0.2955
  Epoch 12 | Step  100 | Loss: 0.2668
  Epoch 12 | Step  150 | Loss: 0.2830
  Epoch 12 | Step  200 | Loss: 0.4011
  Epoch 12 | Step  250 | Loss: 0.2879
  Epoch 12 | Step  300 | Loss: 0.2990
  Epoch 12 | Step  350 | Loss: 0.2970
  Epoch 12 | Step  400 | Loss: 0.4236
  Epoch 12 | Step  450 | Loss: 0.5137
  Epoch 12 | Step  500 | Loss: 0.3161
  Epoch 12 | Step  550 | Loss: 0.2999
  Epoch 12 | Step  600 | Loss: 0.2829
  Epoch 12 | Step  650 | Loss: 0.3138
  Epoch 12 | Step  700 | Loss: 0.3197
  Epoch 12 | Step  750 | Loss: 0.4007
  Epoch 12 | Step  800 | Loss: 0.3142
  Epoch 12 | Step  850 | Loss: 0.2981
  Epoch 12 | Step  900 | Loss: 0.4419
  Epoch 12 | Step  950 | Loss: 0.3303
  Epoch 12 | Step 1000 | Loss: 0.3962
  Epoch 12 | Step 1050 | Loss: 0.3834
  Epoch 12 | Step 1100 | Loss: 0.3672
  Epoch 12 | Step 1150 | Loss: 0.4221
Epoch 12 | Train Loss: 0.3423 | Val Acc: 0.6676 | Val Macro-F1: 0.6721 | Underweight Recall: 0.6186
  -> New best model saved (Macro-F1: 0.6721)
------------------------------------------------------------
  Epoch 13 | Step   50 | Loss: 0.3418
  Epoch 13 | Step  100 | Loss: 0.4009
  Epoch 13 | Step  150 | Loss: 0.2756
  Epoch 13 | Step  200 | Loss: 0.2872
  Epoch 13 | Step  250 | Loss: 0.3145
  Epoch 13 | Step  300 | Loss: 0.2788
  Epoch 13 | Step  350 | Loss: 0.2874
  Epoch 13 | Step  400 | Loss: 0.3047
  Epoch 13 | Step  450 | Loss: 0.2829
  Epoch 13 | Step  500 | Loss: 0.3629
  Epoch 13 | Step  550 | Loss: 0.2943
  Epoch 13 | Step  600 | Loss: 0.3519
  Epoch 13 | Step  650 | Loss: 0.3326
  Epoch 13 | Step  700 | Loss: 0.3606
  Epoch 13 | Step  750 | Loss: 0.3347
  Epoch 13 | Step  800 | Loss: 0.3295
  Epoch 13 | Step  850 | Loss: 0.4538
  Epoch 13 | Step  900 | Loss: 0.3457
  Epoch 13 | Step  950 | Loss: 0.3349
  Epoch 13 | Step 1000 | Loss: 0.3873
  Epoch 13 | Step 1050 | Loss: 0.3417
  Epoch 13 | Step 1100 | Loss: 0.3015
  Epoch 13 | Step 1150 | Loss: 0.3914
Epoch 13 | Train Loss: 0.3393 | Val Acc: 0.6661 | Val Macro-F1: 0.6739 | Underweight Recall: 0.6761
  -> New best model saved (Macro-F1: 0.6739)
------------------------------------------------------------
  Epoch 14 | Step   50 | Loss: 0.3178
  Epoch 14 | Step  100 | Loss: 0.3393
  Epoch 14 | Step  150 | Loss: 0.3007
  Epoch 14 | Step  200 | Loss: 0.3450
  Epoch 14 | Step  250 | Loss: 0.2977
  Epoch 14 | Step  300 | Loss: 0.2932
  Epoch 14 | Step  350 | Loss: 0.2962
  Epoch 14 | Step  400 | Loss: 0.3325
  Epoch 14 | Step  450 | Loss: 0.3135
  Epoch 14 | Step  500 | Loss: 0.2917
  Epoch 14 | Step  550 | Loss: 0.3034
  Epoch 14 | Step  600 | Loss: 0.4597
  Epoch 14 | Step  650 | Loss: 0.2675
  Epoch 14 | Step  700 | Loss: 0.2813
  Epoch 14 | Step  750 | Loss: 0.2943
  Epoch 14 | Step  800 | Loss: 0.2893
  Epoch 14 | Step  850 | Loss: 0.3552
  Epoch 14 | Step  900 | Loss: 0.2962
  Epoch 14 | Step  950 | Loss: 0.3922
  Epoch 14 | Step 1000 | Loss: 0.3969
  Epoch 14 | Step 1050 | Loss: 0.3264
  Epoch 14 | Step 1100 | Loss: 0.3128
  Epoch 14 | Step 1150 | Loss: 0.3528
Epoch 14 | Train Loss: 0.3338 | Val Acc: 0.6794 | Val Macro-F1: 0.6838 | Underweight Recall: 0.6354
  -> New best model saved (Macro-F1: 0.6838)
------------------------------------------------------------
  Epoch 15 | Step   50 | Loss: 0.2885
  Epoch 15 | Step  100 | Loss: 0.3123
  Epoch 15 | Step  150 | Loss: 0.3871
  Epoch 15 | Step  200 | Loss: 0.3159
  Epoch 15 | Step  250 | Loss: 0.2992
  Epoch 15 | Step  300 | Loss: 0.2664
  Epoch 15 | Step  350 | Loss: 0.3476
  Epoch 15 | Step  400 | Loss: 0.3322
  Epoch 15 | Step  450 | Loss: 0.3029
  Epoch 15 | Step  500 | Loss: 0.2910
  Epoch 15 | Step  550 | Loss: 0.2557
  Epoch 15 | Step  600 | Loss: 0.2775
  Epoch 15 | Step  650 | Loss: 0.3316
  Epoch 15 | Step  700 | Loss: 0.3143
  Epoch 15 | Step  750 | Loss: 0.3349
  Epoch 15 | Step  800 | Loss: 0.2715
  Epoch 15 | Step  850 | Loss: 0.3176
  Epoch 15 | Step  900 | Loss: 0.3354
  Epoch 15 | Step  950 | Loss: 0.2889
  Epoch 15 | Step 1000 | Loss: 0.4775
  Epoch 15 | Step 1050 | Loss: 0.4700
  Epoch 15 | Step 1100 | Loss: 0.3825
  Epoch 15 | Step 1150 | Loss: 0.3556
Epoch 15 | Train Loss: 0.3214 | Val Acc: 0.6811 | Val Macro-F1: 0.6848 | Underweight Recall: 0.7159
  -> New best model saved (Macro-F1: 0.6848)
------------------------------------------------------------
  Epoch 16 | Step   50 | Loss: 0.3336
  Epoch 16 | Step  100 | Loss: 0.3469
  Epoch 16 | Step  150 | Loss: 0.3150
  Epoch 16 | Step  200 | Loss: 0.2985
  Epoch 16 | Step  250 | Loss: 0.2730
  Epoch 16 | Step  300 | Loss: 0.3985
  Epoch 16 | Step  350 | Loss: 0.2639
  Epoch 16 | Step  400 | Loss: 0.2861
  Epoch 16 | Step  450 | Loss: 0.3297
  Epoch 16 | Step  500 | Loss: 0.3307
  Epoch 16 | Step  550 | Loss: 0.5713
  Epoch 16 | Step  600 | Loss: 0.3175
  Epoch 16 | Step  650 | Loss: 0.2684
  Epoch 16 | Step  700 | Loss: 0.3065
  Epoch 16 | Step  750 | Loss: 0.2931
  Epoch 16 | Step  800 | Loss: 0.2881
  Epoch 16 | Step  850 | Loss: 0.2950
  Epoch 16 | Step  900 | Loss: 0.2694
  Epoch 16 | Step  950 | Loss: 0.3160
  Epoch 16 | Step 1000 | Loss: 0.2647
  Epoch 16 | Step 1050 | Loss: 0.4166
  Epoch 16 | Step 1100 | Loss: 0.3113
  Epoch 16 | Step 1150 | Loss: 0.3235
Epoch 16 | Train Loss: 0.3237 | Val Acc: 0.6789 | Val Macro-F1: 0.6828 | Underweight Recall: 0.6434
------------------------------------------------------------
  Epoch 17 | Step   50 | Loss: 0.2612
  Epoch 17 | Step  100 | Loss: 0.2873
  Epoch 17 | Step  150 | Loss: 0.2728
  Epoch 17 | Step  200 | Loss: 0.3058
  Epoch 17 | Step  250 | Loss: 0.2686
  Epoch 17 | Step  300 | Loss: 0.3190
  Epoch 17 | Step  350 | Loss: 0.2782
  Epoch 17 | Step  400 | Loss: 0.2709
  Epoch 17 | Step  450 | Loss: 0.2685
  Epoch 17 | Step  500 | Loss: 0.3256
  Epoch 17 | Step  550 | Loss: 0.3682
  Epoch 17 | Step  600 | Loss: 0.2901
  Epoch 17 | Step  650 | Loss: 0.3432
  Epoch 17 | Step  700 | Loss: 0.3449
  Epoch 17 | Step  750 | Loss: 0.2886
  Epoch 17 | Step  800 | Loss: 0.3155
  Epoch 17 | Step  850 | Loss: 0.2700
  Epoch 17 | Step  900 | Loss: 0.2933
  Epoch 17 | Step  950 | Loss: 0.2757
  Epoch 17 | Step 1000 | Loss: 0.4021
  Epoch 17 | Step 1050 | Loss: 0.3564
  Epoch 17 | Step 1100 | Loss: 0.3288
  Epoch 17 | Step 1150 | Loss: 0.2788
Epoch 17 | Train Loss: 0.3199 | Val Acc: 0.6956 | Val Macro-F1: 0.7016 | Underweight Recall: 0.6788
  -> New best model saved (Macro-F1: 0.7016)
------------------------------------------------------------
  Epoch 18 | Step   50 | Loss: 0.2959
  Epoch 18 | Step  100 | Loss: 0.2624
  Epoch 18 | Step  150 | Loss: 0.2925
  Epoch 18 | Step  200 | Loss: 0.2566
  Epoch 18 | Step  250 | Loss: 0.3245
  Epoch 18 | Step  300 | Loss: 0.2788
  Epoch 18 | Step  350 | Loss: 0.3103
  Epoch 18 | Step  400 | Loss: 0.3105
  Epoch 18 | Step  450 | Loss: 0.2643
  Epoch 18 | Step  500 | Loss: 0.3072
  Epoch 18 | Step  550 | Loss: 0.3513
  Epoch 18 | Step  600 | Loss: 0.2951
  Epoch 18 | Step  650 | Loss: 0.2900
  Epoch 18 | Step  700 | Loss: 0.2906
  Epoch 18 | Step  750 | Loss: 0.4187
  Epoch 18 | Step  800 | Loss: 0.3821
  Epoch 18 | Step  850 | Loss: 0.2997
  Epoch 18 | Step  900 | Loss: 0.3246
  Epoch 18 | Step  950 | Loss: 0.2851
  Epoch 18 | Step 1000 | Loss: 0.3129
  Epoch 18 | Step 1050 | Loss: 0.2752
  Epoch 18 | Step 1100 | Loss: 0.3376
  Epoch 18 | Step 1150 | Loss: 0.5854
Epoch 18 | Train Loss: 0.3153 | Val Acc: 0.6941 | Val Macro-F1: 0.6975 | Underweight Recall: 0.7053
------------------------------------------------------------
  Epoch 19 | Step   50 | Loss: 0.3036
  Epoch 19 | Step  100 | Loss: 0.2824
  Epoch 19 | Step  150 | Loss: 0.3126
  Epoch 19 | Step  200 | Loss: 0.3589
  Epoch 19 | Step  250 | Loss: 0.3072
  Epoch 19 | Step  300 | Loss: 0.2789
  Epoch 19 | Step  350 | Loss: 0.2481
  Epoch 19 | Step  400 | Loss: 0.2505
  Epoch 19 | Step  450 | Loss: 0.2618
  Epoch 19 | Step  500 | Loss: 0.2771
  Epoch 19 | Step  550 | Loss: 0.2668
  Epoch 19 | Step  600 | Loss: 0.2789
  Epoch 19 | Step  650 | Loss: 0.2637
  Epoch 19 | Step  700 | Loss: 0.2955
  Epoch 19 | Step  750 | Loss: 0.3740
  Epoch 19 | Step  800 | Loss: 0.3207
  Epoch 19 | Step  850 | Loss: 0.3450
  Epoch 19 | Step  900 | Loss: 0.3547
  Epoch 19 | Step  950 | Loss: 0.2873
  Epoch 19 | Step 1000 | Loss: 0.2645
  Epoch 19 | Step 1050 | Loss: 0.4152
  Epoch 19 | Step 1100 | Loss: 0.3825
  Epoch 19 | Step 1150 | Loss: 0.3407
Epoch 19 | Train Loss: 0.3086 | Val Acc: 0.6850 | Val Macro-F1: 0.6871 | Underweight Recall: 0.6593
------------------------------------------------------------
  Epoch 20 | Step   50 | Loss: 0.2652
  Epoch 20 | Step  100 | Loss: 0.2567
  Epoch 20 | Step  150 | Loss: 0.4705
  Epoch 20 | Step  200 | Loss: 0.2605
  Epoch 20 | Step  250 | Loss: 0.3386
  Epoch 20 | Step  300 | Loss: 0.2533
  Epoch 20 | Step  350 | Loss: 0.2912
  Epoch 20 | Step  400 | Loss: 0.2939
  Epoch 20 | Step  450 | Loss: 0.2715
  Epoch 20 | Step  500 | Loss: 0.2534
  Epoch 20 | Step  550 | Loss: 0.3136
  Epoch 20 | Step  600 | Loss: 0.3530
  Epoch 20 | Step  650 | Loss: 0.2594
  Epoch 20 | Step  700 | Loss: 0.3066
  Epoch 20 | Step  750 | Loss: 0.3781
  Epoch 20 | Step  800 | Loss: 0.2711
  Epoch 20 | Step  850 | Loss: 0.2616
  Epoch 20 | Step  900 | Loss: 0.4708
  Epoch 20 | Step  950 | Loss: 0.2612
  Epoch 20 | Step 1000 | Loss: 0.4017
  Epoch 20 | Step 1050 | Loss: 0.2744
  Epoch 20 | Step 1100 | Loss: 0.3682
  Epoch 20 | Step 1150 | Loss: 0.2664
Epoch 20 | Train Loss: 0.3097 | Val Acc: 0.6983 | Val Macro-F1: 0.7036 | Underweight Recall: 0.6717
  -> New best model saved (Macro-F1: 0.7036)
------------------------------------------------------------

Final evaluation on best model...
Saved confusion matrix to outputs/ablation_scratch/confusion_matrix.png
Saved metrics to outputs/ablation_scratch/metrics.json

============================================================
Training Complete
============================================================
Best Val Accuracy: 0.6983
Best Val Macro-F1: 0.7036
Best Underweight Recall: 0.6717

Artifacts saved to: outputs/ablation_scratch
============================================================
