data:
  train: data/processed_224/train_processed.csv
  val: data/processed_224/val_processed.csv
  img_size: 224
  do_aug: true  # Enabled data augmentation (horizontal flip + rotation)
  skip_resize: true  # Images already preprocessed to 224x224

model:
  backbone: efficientnet_b0
  num_classes: 5
  pretrained: true
  finetune_mode: full  # Fine-tune all parameters
  head_type: ordinal  # Use ordinal regression head (CORAL)

train:
  batch_size: 32
  epochs: 20
  lr: 3e-4
  seed: 42
  num_workers: 2
  device: cuda  # Use CUDA for Google Cloud
  prefetch_factor: 2
  persistent_workers: true
  optimizer: adamw
  weight_decay: 1e-4
  scheduler: cosine  # Cosine annealing learning rate scheduler
  # ordinal_threshold_weights: [2.0, 1.0, 1.0, 1.0]  # Optional: weight first threshold more for underweight detection
  early_stopping:
    enabled: true
    patience: 5
    monitor: val_macro_f1
    mode: max

eval:
  save_confusion_matrix: true
  save_per_class_metrics: true
  class_names: ["3.25", "3.5", "3.75", "4.0", "4.25"]

exp_name: ordinal_b0_224

